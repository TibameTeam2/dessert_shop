<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- 以下三行為取消快取 -->
  <META HTTP-EQUIV="pragma" CONTENT="no-cache">
    <META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
      <META HTTP-EQUIV="expires" CONTENT="0">
        <!-- 以上三行為取消快取 -->

        <title>POS Dash | Responsive Bootstrap 4 Admin Dashboard Template</title>

        <!-- Favicon -->
        <link rel="shortcut icon" href="assets/images/favicon.ico"/>
        <link rel="stylesheet" href="assets/css/backend-plugin.min.css">
        <link rel="stylesheet" href="assets/css/backend.css?v=1.0.0">
        <link rel="stylesheet" href="assets/vendor/@fortawesome/fontawesome-free/css/all.min.css">
        <link rel="stylesheet" href="assets/vendor/line-awesome/dist/line-awesome/css/line-awesome.min.css">
        <link rel="stylesheet" href="assets/vendor/remixicon/fonts/remixicon.css">


        <style media="screen">

        .table-img .product_img_small{
          max-width: 100px;
          max-height: 100px;
        }
        @media (min-width: 576px){
          .modal-dialog{
            max-width:1000px !important;
          }
        }

        .single-comment .comment-author img {
          border-radius: 50%;
          width: 70px;
          height: 70px;
          float: right;
        }


        .ch_m_photo{
          margin-top: 20px;
          margin-left: 40px;
          float: left;
        }

        /* .row {
        --bs-gutter-x: 30px;
        --bs-gutter-y: 0;
        border: 1px solid red;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-wrap: wrap;
        -ms-flex-wrap: wrap;
        flex-wrap: wrap;
        margin-top: calc(var(--bs-gutter-y) * -1);
        margin-right: calc(var(--bs-gutter-x) / -2);
        margin-left: calc(var(--bs-gutter-x) / -2);
      }

      .row>* {
      border: 1px solid pink;
      -webkit-flex-shrink: 0;
      -ms-flex-negative: 0;
      flex-shrink: 0;
      width: 100%;
      max-width: 100%;
      padding-right: calc(var(--bs-gutter-x) / 2);
      padding-left: calc(var(--bs-gutter-x) / 2);
      margin-top: var(--bs-gutter-y);
      } */


      /* 評價的星號 開始 */
      div.star_block {
        display: inline-block;
      }

      div.star_block>span.star {
        cursor: pointer;
        display: inline-block;
        margin-right: 3px;
      }

      div.star_block>span.star.-on {
        color: yellow;
      }
      /* 評價的星號 結束 */

      /* 評價的星號_1 開始 */
      .single-comment .comment-content .author-name-rating {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-align: center;
        -webkit-align-items: center;
        -ms-flex-align: center;
        align-items: center;
        margin-bottom: 10px;
      }
      .single-comment .comment-content .author-name-rating .name {
        font-weight: 600;
        text-transform: capitalize;
        font-size: 14px;
        color: #6c6c6c;
        margin-bottom: 0;
        line-height: 1;
        margin-right: 10px;
      }
      .single-comment .comment-content .author-name-rating .review-star {
        position: relative;
        display: inline-block;
      }
      .single-comment .comment-content .author-name-rating .review-star::before {
        content: "\2605" "\2605" "\2605" "\2605" "\2605";
        font-family: Ionicons;
        display: inline-block;
        color: #dbdbdb;
        font-weight: 400;
        line-height: 1;
        vertical-align: middle;
      }
      .single-comment .comment-content .author-name-rating .review-star .star {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        z-index: 2;
        overflow: hidden;
      }
      .single-comment .comment-content .author-name-rating .review-star .star::before {
        content: "\2605" "\2605" "\2605" "\2605" "\2605";
        /* content: "\f2fc" "\f2fc" "\f2fc" "\f2fc" "\f2fc"; */
        font-family: Ionicons;
        display: inline-block;
        color: #ffc600;
        font-weight: 400;
        line-height: 1;
        vertical-align: middle;
      }
      /* 評價的星號_1 結束 */

      </style>




    </head>
    <body class="  ">
      <!-- loader Start -->
      <div id="loading">
        <div id="loading-center">
        </div>
      </div>
      <!-- loader END -->


      <!-- Wrapper Start -->
      <div class="wrapper">

        <!--Header-->
        <div class="header"></div>


        <!-- 本頁標題 開始 (我是誰? 結束在哪?) -->
        <div class="content-page">
          <div class="container-fluid">
            <div class="row">
              <div class="col-lg-12">
                <div class="d-flex flex-wrap align-items-center justify-content-between mb-4">
                  <div>
                    <h4 class="mb-3">顧客評論</h4>
                    <p class="mb-0">顯示所有顧客的評論，要記得回覆客人喔!</p><br>
                  </div>
                  <a href="page-add-return.html" class="btn btn-primary add-list"><i class="las la-plus mr-3"></i>Add Returns</a>
                </div>
              </div>
              <div class="col-lg-12">
                <div class="table-responsive rounded mb-3">
                  <table class="data-table table mb-0 tbl-server-info">

                    <!-- 項目名稱 開始 -->
                    <thead class="bg-white text-uppercase">
                      <tr class="ligth ligth-data">
                        <th>評論時間</th>
                        <th>訂單明細編號</th>
                        <th>商品名稱</th>
                        <th>會員帳號</th>
                        <th>星等</th>
                        <th>是否回覆</th> <!--請去 Sale-List 抓元素 -->
                        <th>Action</th>
                      </tr>
                    </thead>
                    <!-- 項目名稱 結束 -->


                    <!-- 假資料_客戶評論們 開始 -->
                    <tbody class="ligth-body">
                      <tr>
                        <td>2021-04-13 15:28</td>
                        <td>1</td>
                        <td>巧克力杯子3</td>
                        <td>哆啦 A 夢</td>
                        <!-- 評價星等_1 開始 -->
                        <td>
                          <div class="single-comment">
                            <div class="comment-content">
                              <div class="author-name-rating">
                                <div class="review-star">
                                  <div class="star" style="width: 80%;"></div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </td>
                        <!-- 評價星等_1 結束 -->
                        <td><div data-commentstatus="comment_status"></div></td>
                        <!-- <td><div data-commentstatus="comment_status" class="badge badge-success">Done</div></td> -->
                        <td>
                          <div class="d-flex align-items-center list-action">
                            <a class="badge badge-info mr-2" data-toggle="tooltip" data-placement="top" title="" data-original-title="View" href="#"><i class="ri-eye-line mr-0"></i></a>
                            <a class="badge bg-success mr-2" data-toggle="tooltip" data-placement="top" title="" data-original-title="Edit" href="#"><i class="ri-pencil-line mr-0"></i></a>
                            <a class="badge bg-warning mr-2" data-toggle="tooltip" data-placement="top" title="" data-original-title="Delete" href="#"><i class="ri-delete-bin-line mr-0"></i></a>
                          </div>
                        </td>
                      </tr>

                      <tr>
                        <td>2021-04-13 15:28</td>
                        <td>1</td>
                        <td>巧克力杯子3</td>
                        <td>哆啦 A 夢</td>
                        <!-- 評價星等_1 開始 -->
                        <td>
                          <div class="single-comment">
                            <div class="comment-content">
                              <div class="author-name-rating">
                                <div class="review-star">
                                  <div class="star" style="width: 80%;"></div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </td>
                        <!-- 評價星等_1 結束 -->
                        <td><div class="badge badge-success">Done</div></td>
                        <td>
                          <div class="d-flex align-items-center list-action">
                            <a class="badge badge-info mr-2" data-toggle="tooltip" data-placement="top" title="" data-original-title="View" href="#"><i class="ri-eye-line mr-0"></i></a>
                            <a class="badge bg-success mr-2" data-toggle="tooltip" data-placement="top" title="" data-original-title="Edit" href="#"><i class="ri-pencil-line mr-0"></i></a>
                            <a class="badge bg-warning mr-2" data-toggle="tooltip" data-placement="top" title="" data-original-title="Delete" href="#"><i class="ri-delete-bin-line mr-0"></i></a>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                    <!-- 假資料_客戶評論們 結束 -->

                  </table>
                </div>
              </div>
            </div>
            <!-- Page end  -->
          </div>
          <!-- Modal Edit -->
          <div class="modal fade" id="edit-note" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content">
                <div class="modal-body">
                  <div class="popup text-left">
                    <div class="media align-items-top justify-content-between">
                      <h3 class="mb-3">Product</h3>
                      <div class="btn-cancel p-0" data-dismiss="modal"><i class="las la-times"></i></div>
                    </div>
                    <div class="content edit-notes">
                      <div class="card card-transparent card-block card-stretch event-note mb-0">
                        <div class="card-body px-0 bukmark">
                          <div class="d-flex align-items-center justify-content-between pb-2 mb-3 border-bottom">
                            <div class="quill-tool">
                            </div>
                          </div>
                          <div id="quill-toolbar1">
                            <p>Virtual Digital Marketing Course every week on Monday, Wednesday and Saturday.Virtual Digital Marketing Course every week on Monday</p>
                          </div>
                        </div>
                        <div class="card-footer border-0">
                          <div class="d-flex flex-wrap align-items-ceter justify-content-end">
                            <div class="btn btn-primary mr-3" data-dismiss="modal">Cancel</div>
                            <div class="btn btn-outline-primary" data-dismiss="modal">Save</div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>




          <!-- 跳出的燈箱 開始 -->
          <div class="modal fade" id="lb_view" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content">
                <div class="modal-body">
                  <div class="popup text-left">


                    <!-- 跳出的燈箱_表單 開始 -->
                    <!-- form表單 開始 -->
                    <form action="page-list-product.html" data-toggle="validator">
                      <div class="container-fluid add-form-list">
                        <div class="row">
                          <div class="col-sm-12">
                            <div class="card">
                              <div class="card-header d-flex justify-content-between">
                                <div class="header-title">
                                  <h4 class="card-title">編輯回覆</h4>
                                </div>
                              </div>
                              <div class="card-body">
                                <form action="page-list-product.html" data-toggle="validator">
                                  <div class="row" style="margin:20px">

                                    <div class="col-md-4">
                                      <div class="form-group">
                                        <div class="media">
                                          <img src="assets/images/page-img/15.jpg" class="mr-3 avatar-70 img-fluid rounded" alt="#">
                                          <div class="media-body">
                                            <h5 class="mt-3">Sam</h5>
                                          </div>
                                        </div>
                                      </div>
                                    </div>

                                    <div class="col-md-8">
                                      <ul class="list-group list-group-horizontal" style="float:right; float:top">
                                        <li class="list-group-item">評論的商品<div class="text-primary"> 藍莓乳酪千層蛋糕 </div></li>
                                        <li class="list-group-item">評論編號<div class="text-primary"> 8 </div></li>
                                        <li class="list-group-item">評價星等
                                          <div class="single-comment">
                                            <div class="comment-content">
                                              <div class="author-name-rating">
                                                <div class="review-star">
                                                  <div class="star" style="width: 80%;"></div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                        </li>
                                        <li class="list-group-item">回覆狀態
                                          <div class="text-primary">
                                            <div class="badge badge-warning">尚未回覆</div>
                                            <!-- <div class="badge badge-success">完成回覆</div> -->
                                          </div>
                                        </li>
                                      </ul>
                                    </div>

                                    <div class="col-md-8" style="margin:auto,0">
                                      <div class="form-group">
                                        <label>顧客的評論</label>
                                        <p class="form-control" rows="10">藍莓乳酪蛋糕好吃!</p>
                                        <!-- <span class="form-control" rows="10">藍莓乳酪蛋糕好吃!</span> -->
                                      </div>
                                    </div>

                                    <!-- 表單_顧客上傳的三張照片 開始 -->
                                    <div class="col-md-4" style="margin-top:20px">
                                      <ul class="list-unstyled p-0 m-0 row">
                                        <li class="col-lg-4 col-md-6 col-sm-6 mt-2">
                                          <img src="assets/images/page-img/10.jpg" class="w-100 img-fluid rounded" alt="Responsive image">
                                        </li>
                                        <li class="col-lg-4 col-md-6 col-sm-6 mt-2">
                                          <img src="assets/images/page-img/11.jpg" class="rounded w-100 img-fluid rounded" alt="Responsive image">
                                        </li>
                                        <li class="col-lg-4 col-md-6 col-sm-6 mt-2">
                                          <img src="assets/images/page-img/12.jpg" class="rounded w-100 img-fluid rounded" alt="Responsive image">
                                        </li>
                                      </ul>
                                    </div>
                                    <!-- 表單_顧客上傳的三張照片 結束 -->

                                    <div id="pre-reply" class="col-md-12" style="margin:auto,0">
                                      <div class="form-group">
                                        <label>先前的回覆</label>
                                        <span class="form-control" rows="10">謝謝!</span>
                                      </div>
                                    </div>

                                    <!-- 表單_回覆顧客 開始 -->
                                    <div class="col-md-12">
                                      <div class="form-group">
                                        <label>回覆顧客 *</label>
                                        <textarea class="form-control" placeholder="謝謝您的光臨 . . ." data-errors="Please Enter Cost." rows="4" required></textarea>
                                        <div class="help-block with-errors"></div>
                                      </div>
                                    </div>
                                    <!-- 表單_回覆顧客 結束 -->


                                    <!-- 表單_請選擇員工帳號 開始 -->
                                    <div class="col-md-12">
                                      <div class="form-group">
                                        <label>請選擇員工帳號 *</label>
                                        <select name="type" class="form-control" placeholder="我是 . . ." data-style="py-0" required>
                                          <option value>請選擇員工帳號</option>
                                          <option value="1">員工一號</option>
                                          <option value="2">員工二號</option>
                                        </select>
                                      </div>
                                    </div>
                                    <!-- 表單_請選擇員工帳號 結束 -->

                                  </div>
                                </form>
                                <button type="submit" class="btn btn-primary mr-2">Add Product</button>
                                <button type="reset" class="btn btn-danger">Reset</button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>
                      <!-- form表單 結束 -->
                      <!-- 跳出的燈箱_表單 結束 -->


                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- 跳出的燈箱 結束 -->


            <!-- Backend Bundle JavaScript -->
            <script src="assets/js/backend-bundle.min.js"></script>

            <!-- Table Treeview JavaScript -->
            <script src="assets/js/table-treeview.js"></script>

            <!-- Chart Custom JavaScript -->
            <script src="assets/js/customizer.js"></script>

            <!-- Chart Custom JavaScript -->
            <script async src="assets/js/chart-custom.js"></script>

            <!-- app JavaScript -->
            <script src="assets/js/app.js"></script>

            <!-- Timestamp轉指定格式 -->
            <script src="assets/js/moment.js"></script>

            <!-- 加入script   footer用不到 -->
            <script>
            $(document).ready(function () {
              $('.header').load('header.html')
              // $('.footer').load('footer.html')
            })
            </script>


            <!-- 以下為js功能 -->
            <script type="text/javascript">

            getAllComment();
            function getAllComment(){
              var action = '<div class="d-flex align-items-center list-action">\n'
              + '<a class="badge badge-info mr-2" data-toggle="modal" data-target="#lb_view" data-placement="top" title="" data-original-title="View"><i class="ri-pencil-line mr-0"></i></a>\n'
              + '<a class="badge bg-warning mr-2" data-toggle="tooltip" data-placement="top" title="" data-original-title="Delete" href="#"><i class="ri-delete-bin-line mr-0"></i></a>\n'
              + '</div>';


              //取得所有評論資料(listMemberComment)的get請求
              $.get("/dessert_shop/listMemberComment/getListMemberComment", {}, function(data){
                console.log("取得所有評論資料(listMemberComment)的	$.get的:");
                console.log("data.data.length = " + data.data.length);
                console.log("data.data = " + data.data);
                console.log(data.data);
                console.log("------------------------");

                //欲得到所有評論資料(listMemberComment)的get請求
                if(data.flag){
                  let table = $(".data-table").DataTable();
                  table.destroy();
                  table = $(".data-table").DataTable({
                    "autoWidth": false,
                    "lengthMenu": [10, 20],     //顯示XX項結果
                    // "lengthMenu": [3, 5, 10, 20],     //顯示XX項結果
                    "language": {
                      "processing": "處理中...",
                      "loadingRecords": "載入中...",
                      "lengthMenu": "顯示 _MENU_ 項結果",
                      "zeroRecords": "沒有符合的結果",
                      "info": "顯示第 _START_ 至 _END_ 項結果，共 _TOTAL_ 項",
                      "infoEmpty": "顯示第 0 至 0 項結果，共 0 項",
                      "infoFiltered": "(從 _MAX_ 項結果中過濾)",
                      "infoPostFix": "",
                      "search": "搜尋:",
                      "paginate": {
                        "first": "第一頁",
                        "previous": "上一頁",
                        "next": "下一頁",
                        "last": "最後一頁"
                      },
                      "aria": {
                        "sortAscending": ": 升冪排列",
                        "sortDescending": ": 降冪排列"
                      }
                    },
                    // "columns": [
                    //     { "data": "name" }, //第一欄使用data中的name
                    //     { "data": "age" } //第二欄使用data中的age
                    // ],
                    // "columns": [
                    //     {
                    //         title: "會員帳號",
                    //         data: "member_account"
                    //     },
                    //     {
                    //         title: "會員密碼",
                    //         data: "member_password"
                    //     },
                    // ]
                    "columnDefs": [
                      {
                        "targets": [1],    //欄位從0開始算
                        "visible": true,   //欄位是否顯示 預設是true
                        "orderable": false  //是否可以排序
                      },
                      {
                        "targets": [2],    //欄位從0開始算
                        "visible": true,   //欄位是否顯示 預設是true
                        "orderable": false,  //是否可以排序
                        "width": "1%"
                      }
                    ]
                  })
                  table.clear().draw();

                  //get請求內第一個for迴圈
                  for(let i = 0; i < data.data.length; i++){
                    table.row.add([
                      moment(data.data[i].comment_time).format('YYYY-MM-DD HH:mm:ss'),
                      data.data[i].order_detail_id,
                      // '<img class="table-img" src="dessert_shop/product_jsp/product.do?action=getProductImage&id=' + data.data[i].image_id + '">',
                      data.data[i].product_name,
                      data.data[i].member_account,
                      getStarShine(data.data[i].rating),
                      getCommentStatus(data.data[i].comment_status),
                      action

                      // data.data[i].review_id,
                      // data.data[i].product_id,
                      // data.data[i].comment_content,
                      // data.data[i].reply_id,
                      // data.data[i].reply_content,
                      // data.data[i].product_id,
                      // moment(data.data[i].reply_time).format('YYYY-MM-DD HH:mm:ss'),
                      // data.data[i].employee_account,
                      // data.data[i].review_image_id,
                      // data.data[i].review_image,

                    ]).draw(false);


                  } //get請求內第一個for迴圈

                } //if(data.flag)

                console.log(this);
                console.log(1111111111111);

              }) //取得所有評論資料(listMemberComment)的get請求

            } //getAllComment()

            // $(this).closest("a[data-original-title='View']").on('click', function(){
            //   console.log("按按按");
            //   console.log(this);
            //   $("#lb_view").modal('show');
            // })

            console.log(2222222);



            function getStarShine(rating){

              switch (Number(rating)) {
                //試過:has, filter, find
                case 1:
                let starx1 = '<div class="single-comment">\n'
                + '<div class="comment-content">\n'
                + '<div class="author-name-rating">\n'
                + '<div class="review-star">\n'
                + '<div class="star" style="width: 20%;"></div>\n'
                + '</div>\n'
                + '</div>\n'
                + '</div>\n'
                + '</div>';
                return starx1;

                case 2:
                let starx2 = '<div class="single-comment">\n'
                + '<div class="comment-content">\n'
                + '<div class="author-name-rating">\n'
                + '<div class="review-star">\n'
                + '<div class="star" style="width: 40%;"></div>\n'
                + '</div>\n'
                + '</div>\n'
                + '</div>\n'
                + '</div>';
                return starx2;

                case 3:
                let starx3 = '<div class="single-comment">\n'
                + '<div class="comment-content">\n'
                + '<div class="author-name-rating">\n'
                + '<div class="review-star">\n'
                + '<div class="star" style="width: 60%;"></div>\n'
                + '</div>\n'
                + '</div>\n'
                + '</div>\n'
                + '</div>';
                return starx3;

                case 4:
                let starx4 = '<div class="single-comment">\n'
                + '<div class="comment-content">\n'
                + '<div class="author-name-rating">\n'
                + '<div class="review-star">\n'
                + '<div class="star" style="width: 80%;"></div>\n'
                + '</div>\n'
                + '</div>\n'
                + '</div>\n'
                + '</div>';
                return starx4;

                case 5:
                let starx5 = '<div class="single-comment">\n'
                + '<div class="comment-content">\n'
                + '<div class="author-name-rating">\n'
                + '<div class="review-star">\n'
                + '<div class="star" style="width: 100%;"></div>\n'
                + '</div>\n'
                + '</div>\n'
                + '</div>\n'
                + '</div>';
                return starx5;

                default:
                return starx5;
              }
            }

            function getCommentStatus(comment_status){
              switch (Number(comment_status)) {
                case 0:
                let notyet = '<div class="badge badge-warning">尚未回覆</div>';
                return notyet;
                case 1:
                let done = '<div class="badge badge-success">完成回覆</div>';
                return done;
                default:
                return notyet;
              }
            }


            </script>




          </body>
          </html>
