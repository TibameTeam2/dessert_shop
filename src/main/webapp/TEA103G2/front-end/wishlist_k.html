<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>嗜甜-收藏清單</title>
  <meta name="robots" content="noindex, follow" />
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="assets/images/favicon.png">

  <!-- CSS
  ============================================ -->

  <!-- Icon Font CSS -->
  <link rel="stylesheet" href="assets/css/plugins/ionicons.min.css">
  <link rel="stylesheet" href="assets/css/plugins/line-awesome.min.css">
  <link rel="stylesheet" href="assets/css/plugins/fontawesome.min.css">

  <!-- Plugins CSS -->
  <link rel="stylesheet" href="assets/css/plugins/animate.min.css">
  <link rel="stylesheet" href="assets/css/plugins/swiper-bundle.min.css">
  <link rel="stylesheet" href="assets/css/plugins/nice-select.css">
  <link rel="stylesheet" href="assets/css/plugins/select2.min.css">
  <link rel="stylesheet" href="assets/css/plugins/jquery-ui.min.css">
  <link rel="stylesheet" href="assets/css/plugins/magnific-popup.css">

  <!-- Main Style CSS -->
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="assets/css/custom.css">

  <!--====== Use the minified version files listed below for better performance and remove the files listed above ======-->
  <!-- <link rel="stylesheet" href="assets/css/vendor/plugins.min.css">
  <link rel="stylesheet" href="assets/css/style.min.css"> -->
  <style>
  .cart-wrapper {
    width: 80%;
    margin: auto;
  }

</style>


</head>

<body>

  <!-- Loading Progress 開始-->
  <div id="loading-progress">
    <a class="logo" href="#">
      <img src="assets/images/logo.jpg" data-logo-alt="images/files/logo-header.png" alt="">
      <!--        <h3><span class="colored">Astron</span></h3>-->
      <!--        <span>HTML Template</span>-->
    </a><!-- .logo end -->
    <div class="lp-content">
      <div class="lp-counter">
        Loading
        <div id="lp-counter">0%</div>
      </div><!-- .lp-counter end -->
      <div class="lp-bar">
        <div id="lp-bar"></div>
      </div><!-- .lp-bar end -->
    </div><!-- .lp-content end -->
  </div>
  <!-- loading-progress 結束 -->

  <div class="main-wrapper">

    <!--Header-->
    <div class="header"></div>

    <div class="menu-overlay"></div>

    <!--Page Banner Start-->
    <div class="section page-banner-wrapper bg-cover" style="background-image: url(assets/images/page-banner.jpg);">
      <div class="container">
        <div class="page-banner">
          <ul class="breadcrumb justify-content-center">
            <li class="breadcrumb-item"><a href="index.html">首頁</a></li>
            <li class="breadcrumb-item active">收藏清單</li>
          </ul>
        </div>
      </div>
    </div>
    <!--Page Banner Start-->

    <!-- Shopping Cart Section Start -->
    <div class="section section-padding-02">
      <div class="container">
        <div class="cart-wrapper">
          <!-- Cart Wrapper Start -->
          <div class="cart-table table-responsive">
            <table class="table">

              <!-- 上方項目名稱 開始 -->
              <thead style="width:100px">
                <tr>
                  <th class="Product-thumb" style="width:25%">商品照片</th>
                  <th class="Product-info" style="width:25%">商品資訊</th>
                  <!-- <th class="Product-quantity">數量</th>
                  <th class="Product-total-price">總金額</th> -->
                  <th class="Product-add-cart">加入購物車</th>
                  <th class="Product-action">刪除</th>
                </tr>
              </thead>
              <!-- 上方項目名稱 結束 -->

              <!-- 收藏項目 開始 -->
              <tbody id="wish">

                <!-- 第一個收藏項目 開始 -->
                <!-- <tr> -->

                <!-- 商品照片 開始 -->
                <!-- <td class="Product-thumb view_product_image">
                <img src="" alt="">
              </td> -->
              <!-- 商品照片 結束 -->

              <!-- 商品資訊 開始 -->
              <!-- <td class="Product-info">
              <h6 class="name view_product_name"><a href="shop-single.html">草莓千層</a></h6>
              <div class="product-prices">
              <span class="old-price view_product_pice">$35.90</span>
              <span class="sale-price view_discount_price">$28.72</span>
              <span class="discount-percentage">Save 20%</span>
            </div>
            <div class="product-size-color">
            <p>主分類 <span class="view_product_type">蛋糕</span></p>
            <p>子分類 <span class="view_product_subtype">千層蛋糕 </span></p>
          </div>
        </td> -->
        <!-- 商品資訊 結束 -->

        <!-- 商品數量 開始 -->
        <!-- <td class="quantity">
        <div class="product-quantity d-inline-flex">
        <button type="button" class="sub"><i class="ion-ios-arrow-down"></i></button>
        <input type="text" value="1" />
        <button type="button" class="add"><i class="ion-ios-arrow-up"></i></button>
      </div>
    </td> -->
    <!-- 商品數量 結束 -->

    <!-- 該商品總金額 開始 -->
    <!-- <td class="Product-total-price">
    <span class="price">$28.72</span>
  </td> -->
  <!-- 該商品總金額 結束 -->

  <!-- 加入購物車鈕 開始 -->
  <!-- <td class="Product-add-cart">
  <a href="#" class="btn btn-dark btn-hover-primary">加入購物車</a>
</td> -->
<!-- 加入購物車鈕 結束 -->

<!-- 刪除該商品 開始 -->
<!-- <td class="Product-action">
<a href="javascript:void(0)" class="remove"><i class="lar la-trash-alt"></i></a>
</td> -->
<!-- 刪除該商品 結束 -->

<!-- </tr> -->


<!-- 第一個收藏項目 結束 -->


<!-- 第二個收藏項目 開始 -->
<!-- <tr>
<td class="Product-thumb">
<img src="assets/images/product/product-04.jpg" alt="">
</td>
<td class="Product-info">
<h6 class="name"><a href="shop-single.html">Originals Kaval Windbreaker Winter Jacket</a></h6>
<div class="product-prices">
<span class="sale-price">$35.72</span>
</div>
<div class="product-size-color">
<p>Size <span>S</span></p>
<p>Color <span>White</span></p>
</div>
</td>
<td class="quantity">
<div class="product-quantity d-inline-flex">
<button type="button" class="sub"><i class="ion-ios-arrow-down"></i></button>
<input type="text" value="1" />
<button type="button" class="add"><i class="ion-ios-arrow-up"></i></button>
</div>
</td>
<td class="Product-total-price">
<span class="price">$28.72</span>
</td>
<td class="Product-add-cart">
<a href="#" class="btn btn-dark btn-hover-primary">Add to Cart</a>
</td>
<td class="Product-action">
<a href="#" class="remove"><i class="lar la-trash-alt"></i></a>
</td>
</tr> -->
<!-- 第二個收藏項目 結束 -->


<!-- 第三個收藏項目 開始 -->
<!-- <tr>
<td class="Product-thumb">
<img src="assets/images/product/product-08.jpg" alt="">
</td>
<td class="Product-info">
<h6 class="name"><a href="shop-single.html">Originals Kaval Windbreaker Winter Jacket</a></h6>
<div class="product-prices">
<span class="sale-price">$28.72</span>
</div>
<div class="product-size-color">
<p>Size <span>S</span></p>
<p>Color <span>White</span></p>
</div>
</td>
<td class="quantity">
<div class="product-quantity d-inline-flex">
<button type="button" class="sub"><i class="ion-ios-arrow-down"></i></button>
<input type="text" value="1" />
<button type="button" class="add"><i class="ion-ios-arrow-up"></i></button>
</div>
</td>
<td class="Product-total-price">
<span class="price">$28.72</span>
</td>
<td class="Product-add-cart">
<a href="#" class="btn btn-dark btn-hover-primary">Add to Cart</a>
</td>
<td class="Product-action">
<a href="#" class="remove"><i class="lar la-trash-alt"></i></a>
</td>
</tr> -->
<!-- 第三個收藏項目 結束 -->

</tbody>
<!-- 收藏項目 結束 -->


</table>
</div>
<!-- Cart Wrapper End -->
</div>
</div>
</div>
<!-- Shopping Cart Section End -->


<!--Footer-->
<div class="footer"></div>

</div>







<!-- JS
============================================ -->

<!-- Modernizer & jQuery JS -->
<script src="assets/js/vendor/modernizr-3.11.2.min.js"></script>
<script src="assets/js/vendor/jquery-3.5.1.min.js"></script>

<!-- Bootstrap JS -->
<script src="assets/js/plugins/popper.min.js"></script>
<script src="assets/js/plugins/bootstrap.min.js"></script>

<!-- Plugins JS -->
<script src="assets/js/plugins/swiper-bundle.min.js"></script>
<script src="assets/js/plugins/jquery.nice-select.min.js"></script>
<script src="assets/js/plugins/select2.min.js"></script>
<script src="assets/js/plugins/jquery-ui.min.js"></script>
<script src="assets/js/plugins/jquery.magnific-popup.min.js"></script>
<script src="assets/js/plugins/jquery.zoom.min.js"></script>
<script src="assets/js/plugins/ajax-contact.js"></script>

<!--====== Use the minified version files listed below for better performance and remove the files listed above ======-->
<!-- <script src="assets/js/plugins.min.js"></script> -->


<!-- Main JS -->
<script src="assets/js/main.js"></script>

<!-- Modernizer & jQuery JS -->
<script src="assets/js/vendor/modernizr-3.11.2.min.js"></script>
<script src="assets/js/vendor/jquery-3.5.1.min.js"></script>
<script src="assets/js/vendor/jquery.waitforimages.min.js"></script>
<script src="assets/js/plugins/sweetalert2.all.min.js"></script>

<script>

$(document).ready(function () {
  $('.header').load('header.html')
  $('.footer').load('footer.html')
})


//加入腳本在頁面加載完成時 消失loading畫面
$("body").waitForImages({
  finished: function () {
    setTimeout(function () {
      $(".lp-content, #loading-progress .logo").css({opacity: 0})
      $("#loading-progress").addClass("hide-it"),
      setTimeout(function () {
        $(".banner-parallax > .bg-element, .banner-parallax > .overlay-pattern").addClass("appeared")
      }, 1000)
    }, 0)
  }, each: function (a, t, e) {
    var n = Math.floor((a + 1) / t * 100);
    $("#lp-counter").animate({$this: n}, {
      duration: 150, easing: "", queue: !1, step: function (a) {
        var t = Math.round(a);
        $("#lp-counter").text(t + "%")
      }
    }), $("#lp-bar").animate({width: n + "%"}, 0)
  }, waitForAll: !0
});

</script>

<script>

$.get("/dessert_shop/bucketList/getMyBucketList", {}, function(data) {

  for (let i = 0; i < data.data.length; i++) {
    let bucket_list_id = data.data[i].bucket_list_id;
    let member_account = data.data[i].member_account;
    let product_id = data.data[i].product_id;
    let bucket_list_status = data.data[i].bucket_list_status;
    let product_name = data.data[i].product_name;
    let product_type = data.data[i].product_type;
    let product_subtype = data.data[i].product_subtype;
    let product_price = data.data[i].product_price;
    let product_available_qty = data.data[i].product_available_qty;
    let discount_price = data.data[i].discount_price;

    let image_id = data.data[i].image_id;
    let product_image = data.data[i].product_image;

    let wish = `<tr data-productid="${product_id}">
    <!-- 商品照片 開始 -->
    <td class="Product-thumb view_product_image">
    <img src="/dessert_shop${product_image}" alt="">
    </td>
    <!-- 商品照片 結束 -->

    <!-- 商品資訊 開始 -->
    <td class="Product-info">
    <h6 class="name view_product_name"><a href="shop-single.html">${product_name}</a></h6>
    <div class="product-prices">
    <span class="sale-price view_product_pice">$ ${product_price} 元</span>
    <!-- <span class="old-price view_product_pice">價格:${product_price}</span> -->
    <!-- <span class="sale-price view_discount_price">${discount_price}</span> -->
    <!-- <span class="discount-percentage">Save 20%</span> -->
    </div>
    <div class="product-size-color">
    <p>主分類 <span class="view_product_type">${product_type}</span></p>
    <p>子分類 <span class="view_product_subtype">${product_subtype}</span></p>
    </div>
    </td>
    <!-- 商品資訊 結束 -->

    <!-- 商品數量 開始 -->
    <!-- <td class="quantity">
    <div class="product-quantity d-inline-flex">
    <button type="button" class="sub"><i class="ion-ios-arrow-down"></i></button>
    <input type="text" value="1" />
    <button type="button" class="add"><i class="ion-ios-arrow-up"></i></button>
    </div>
    </td> -->
    <!-- 商品數量 結束 -->

    <!-- 該商品總金額 開始 -->
    <!-- <td class="Product-total-price">
    <span class="price">$28.72</span>
    </td> -->
    <!-- 該商品總金額 結束 -->

    <!-- 加入購物車鈕 開始 -->
    <td class="Product-add-cart">
    <a href="#" class="btn btn-dark btn-hover-primary add-cart">加入購物車</a>
    </td>
    <!-- 加入購物車鈕 結束 -->

    <!-- 刪除該商品 開始 -->
    <td class="Product-action">
    <a href="javascript:void(0)" class="remove"><i class="lar la-trash-alt"></i></a>
    </td>
    <!-- 刪除該商品 結束 -->

    </tr>`;

    if(discount_price != null){
      $('div.product-prices').find('span.old-price').after('<span class="sale-price view_discount_price">'+ discount_price +'</span>');
    }

    $('#wish').prepend(wish);
  }

})




// 按下「垃圾桶」,是把bucket_list_status狀態改為0(因怡榕說有分析價值), 且不顯示該商品。
$("body").on("click", "a.remove", function(){
  let ProductId = $(this).closest('tr').attr('data-productid');

  $.get("/dessert_shop/bucketList/changeBucketListStatusToZero", {"ProductId" : ProductId}, function() {
  })

  $(this).closest('tr[data-productid]').remove();
  wishQtyMinusOne();
});



// 加入購物車
$("body").on("click", ".add-cart", function(){
  let product_id= $(this).closest("tr").attr("data-productid");
  // API要給id 跟數量 如果頁面沒有數量可以選 設為1
  $.post("/dessert_shop/cart/insertProductIntoCart?product_id="+product_id+"&product_quantity=1",{},function(data){
    console.log("加入購物車回傳的flag:"+data.flag);
    if(data.flag == false){
      Swal.fire({
        title: data.msg,
        text: "請先登入帳號!",
        icon: "error"
      }).then(function(){
        location.href="login.html";
      });
    }else {
      Swal.fire({
        title: "已加入購物車",
        text: "",
        icon: "success"
      })
      cartQty();
    }
  });//$.post
});


</script>


</body>

</html>
